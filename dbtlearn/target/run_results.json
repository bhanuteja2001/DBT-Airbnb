{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-11-14T06:54:06.600817Z", "invocation_id": "724afe9a-3adc-4d41-b1f1-21761d1fb537", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.547325Z", "completed_at": "2024-11-14T06:54:06.548312Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.549398Z", "completed_at": "2024-11-14T06:54:06.549408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040950775146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtlearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.552885Z", "completed_at": "2024-11-14T06:54:06.556889Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.558032Z", "completed_at": "2024-11-14T06:54:06.558041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007372617721557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "\nwith  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\n    SELECT\n        *\n    FROM\n       AIRBNB.raw.raw_hosts\n)\nSELECT\n    id AS host_id,\n    NAME AS host_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    raw_hosts\n), src_hosts as (\n    SELECT * FROM __dbt__cte__src_hosts\n\n)\nSELECT\nHOST_ID,\nNVL(HOST_NAME, 'Anonymous') AS host_name,\nis_superhost,\nCREATED_AT,\nUPDATED_AT\nfrom src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.561373Z", "completed_at": "2024-11-14T06:54:06.566528Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.567634Z", "completed_at": "2024-11-14T06:54:06.567643Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00832676887512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_listings\n)\nSELECT\n    id AS listing_id,\n    name AS listing_name,\n    listing_url,\n    room_type,\n    minimum_nights,\n    host_id,\n    price AS price_str,\n    created_at,\n    updated_at\nFROM\n    raw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM\n    __dbt__cte__src_listings\n)\nSELECT\n  listing_id,\n  listing_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  REPLACE(\n    price_str,\n    '$'\n  ) :: NUMBER(\n    10,\n    2\n  ) AS price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.571099Z", "completed_at": "2024-11-14T06:54:06.580130Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.581286Z", "completed_at": "2024-11-14T06:54:06.581293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012274026870727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_reviews\n)\nSELECT\n    LISTING_ID,\n    DATE AS REVIEW_DATE,\n    REVIEWER_NAME,\n    COMMENTS AS REVIEW_TEXT,\n    SENTIMENT AS REVIEW_SENTIMENT\n    \nFROM\n    raw_reviews\n), src_reviews AS (\n  SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT * FROM src_reviews\nWHERE review_text is not null\n\n\n  AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.584689Z", "completed_at": "2024-11-14T06:54:06.587308Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.588428Z", "completed_at": "2024-11-14T06:54:06.588436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0058040618896484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n    SELECT * \n    FROM AIRBNB.DEV.dim_hosts_cleansed\n)\n\nSELECT \n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-14T06:54:06.591869Z", "completed_at": "2024-11-14T06:54:06.596749Z"}, {"name": "execute", "started_at": "2024-11-14T06:54:06.597838Z", "completed_at": "2024-11-14T06:54:06.597845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008168935775756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.full_moon_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\n\nSELECT\n  r.*,\n  CASE\n    WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n    ELSE 'full moon'\n  END AS is_full_moon\nFROM\n  fct_reviews\n  r\n  LEFT JOIN full_moon_dates\n  fm\n  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.full_moon_reviews"}], "elapsed_time": 0.7018616199493408, "args": {"log_level_file": "debug", "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "use_colors_file": true, "defer": false, "introspect": true, "send_anonymous_usage_stats": true, "show_resource_report": false, "exclude": [], "printer_width": 80, "inject_ephemeral_ctes": true, "strict_mode": false, "select": [], "populate_cache": true, "static_parser": true, "version_check": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "invocation_command": "dbt compile", "quiet": false, "use_colors": true, "indirect_selection": "eager", "enable_legacy_logger": false, "macro_debugging": false, "partial_parse": true, "log_path": "/workspaces/DBT-Airbnb/dbtlearn/logs", "require_explicit_package_overrides_for_builtin_materializations": false, "write_json": true, "output": "text", "vars": {}, "log_format": "default", "favor_state": false, "print": true, "project_dir": "/workspaces/DBT-Airbnb/dbtlearn", "which": "compile", "cache_selected_only": false, "profiles_dir": "/home/codespace/.dbt"}}