{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2024-11-16T20:07:42.948358Z", "invocation_id": "f61d0796-ceda-49e9-88f3-bffad1af2bc6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.297717Z", "completed_at": "2024-11-16T20:07:42.298943Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.300020Z", "completed_at": "2024-11-16T20:07:42.300030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0043337345123291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtlearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.303344Z", "completed_at": "2024-11-16T20:07:42.305654Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.306761Z", "completed_at": "2024-11-16T20:07:42.306770Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0054683685302734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM AIRBNB.raw.raw_hosts\n", "relation_name": "AIRBNB.dev.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.310078Z", "completed_at": "2024-11-16T20:07:42.312423Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.313517Z", "completed_at": "2024-11-16T20:07:42.313526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005518198013305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\nselect * FROM AIRBNB.raw.raw_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.316996Z", "completed_at": "2024-11-16T20:07:42.321659Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.322828Z", "completed_at": "2024-11-16T20:07:42.322835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008032560348510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "\nwith  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\n    SELECT\n        *\n    FROM\n       AIRBNB.raw.raw_hosts\n)\nSELECT\n    id AS host_id,\n    NAME AS host_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    raw_hosts\n), src_hosts as (\n    SELECT * FROM __dbt__cte__src_hosts\n\n)\nSELECT\nHOST_ID,\nNVL(HOST_NAME, 'Anonymous') AS host_name,\nis_superhost,\nCREATED_AT,\nUPDATED_AT\nfrom src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.326292Z", "completed_at": "2024-11-16T20:07:42.331569Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.332665Z", "completed_at": "2024-11-16T20:07:42.332673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008441448211669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_listings\n)\nSELECT\n    id AS listing_id,\n    name AS listing_name,\n    listing_url,\n    room_type,\n    minimum_nights,\n    host_id,\n    price AS price_str,\n    created_at,\n    updated_at\nFROM\n    raw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM\n    __dbt__cte__src_listings\n)\nSELECT\n  listing_id,\n  listing_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  REPLACE(\n    price_str,\n    '$'\n  ) :: NUMBER(\n    10,\n    2\n  ) AS price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.336234Z", "completed_at": "2024-11-16T20:07:42.359863Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.360981Z", "completed_at": "2024-11-16T20:07:42.360988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02682662010192871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_reviews\n)\nSELECT\n    LISTING_ID,\n    DATE AS REVIEW_DATE,\n    REVIEWER_NAME,\n    COMMENTS AS REVIEW_TEXT,\n    SENTIMENT AS REVIEW_SENTIMENT\n    \nFROM\n    raw_reviews\n), src_reviews AS (\n  SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT \n  md5(cast(coalesce(cast(listing_id as \n    varchar\n), '') || '-' || coalesce(cast(review_date as \n    varchar\n), '') || '-' || coalesce(cast(reviewer_name as \n    varchar\n), '') || '-' || coalesce(cast(review_text as \n    varchar\n), '') as \n    varchar\n))\n    AS review_id,\n  * \n  FROM src_reviews\nWHERE review_text is not null\n\n  AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.365051Z", "completed_at": "2024-11-16T20:07:42.375792Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.376947Z", "completed_at": "2024-11-16T20:07:42.376954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014574050903320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_superhost as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_hosts_cleansed\n    group by is_superhost\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    't','f'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.380286Z", "completed_at": "2024-11-16T20:07:42.387391Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.388538Z", "completed_at": "2024-11-16T20:07:42.388546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010348796844482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.391937Z", "completed_at": "2024-11-16T20:07:42.395660Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.396816Z", "completed_at": "2024-11-16T20:07:42.396823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006954669952392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_name\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.400156Z", "completed_at": "2024-11-16T20:07:42.405448Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.406620Z", "completed_at": "2024-11-16T20:07:42.406626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00855398178100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    host_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_id is not null\ngroup by host_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.410026Z", "completed_at": "2024-11-16T20:07:42.413443Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.414573Z", "completed_at": "2024-11-16T20:07:42.414579Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006712675094604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n    SELECT * \n    FROM AIRBNB.DEV.dim_hosts_cleansed\n)\n\nSELECT \n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.417969Z", "completed_at": "2024-11-16T20:07:42.423435Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.424592Z", "completed_at": "2024-11-16T20:07:42.424598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008752822875976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_listings_cleansed\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.428127Z", "completed_at": "2024-11-16T20:07:42.430682Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.431807Z", "completed_at": "2024-11-16T20:07:42.431814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005918979644775391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dim_listings_minumum_nights", "compiled": true, "compiled_code": "SELECT\n    *\nFROM\n    AIRBNB.DEV.dim_listings_cleansed\nWHERE minimum_nights < 1\nLIMIT 10", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.435112Z", "completed_at": "2024-11-16T20:07:42.780498Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.781594Z", "completed_at": "2024-11-16T20:07:42.781604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42191195487976074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "\n    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE\n    LISTING_ID IS NULL OR\n    LISTING_NAME IS NULL OR\n    ROOM_TYPE IS NULL OR\n    MINIMUM_NIGHTS IS NULL OR\n    HOST_ID IS NULL OR\n    PRICE IS NULL OR\n    CREATED_AT IS NULL OR\n    UPDATED_AT IS NULL OR\n    \n    FALSE\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.858397Z", "completed_at": "2024-11-16T20:07:42.863116Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.865145Z", "completed_at": "2024-11-16T20:07:42.865152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009310245513916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.869493Z", "completed_at": "2024-11-16T20:07:42.873217Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.874441Z", "completed_at": "2024-11-16T20:07:42.874447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007123470306396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.877779Z", "completed_at": "2024-11-16T20:07:42.884838Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.886008Z", "completed_at": "2024-11-16T20:07:42.886014Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010316133499145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from AIRBNB.DEV.dim_listings_cleansed\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from AIRBNB.DEV.dim_hosts_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.889354Z", "completed_at": "2024-11-16T20:07:42.892878Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.894025Z", "completed_at": "2024-11-16T20:07:42.894031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0067479610443115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.897298Z", "completed_at": "2024-11-16T20:07:42.900264Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.901382Z", "completed_at": "2024-11-16T20:07:42.901389Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006117343902587891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.full_moon_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\n\nSELECT\n  r.*,\n  CASE\n    WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n    ELSE 'full moon'\n  END AS is_full_moon\nFROM\n  fct_reviews\n  r\n  LEFT JOIN full_moon_dates\n  fm\n  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.full_moon_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.904813Z", "completed_at": "2024-11-16T20:07:42.910269Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.911529Z", "completed_at": "2024-11-16T20:07:42.911535Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008802652359008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        review_sentiment as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.fct_reviews\n    group by review_sentiment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'positive','neutral','negative'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.914959Z", "completed_at": "2024-11-16T20:07:42.917771Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.918982Z", "completed_at": "2024-11-16T20:07:42.918989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0062046051025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.consistent_created_at", "compiled": true, "compiled_code": "SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l\nINNER JOIN AIRBNB.DEV.fct_reviews r\nUSING (listing_id)\nWHERE l.created_at >= r.review_date", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.922395Z", "completed_at": "2024-11-16T20:07:42.927141Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.928347Z", "completed_at": "2024-11-16T20:07:42.928354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008088827133178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_name\nfrom AIRBNB.DEV.fct_reviews\nwhere reviewer_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.931797Z", "completed_at": "2024-11-16T20:07:42.936566Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.937799Z", "completed_at": "2024-11-16T20:07:42.937806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008323907852172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select listing_id as from_field\n    from AIRBNB.DEV.fct_reviews\n    where listing_id is not null\n),\n\nparent as (\n    select listing_id as to_field\n    from AIRBNB.DEV.dim_listings_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-16T20:07:42.941423Z", "completed_at": "2024-11-16T20:07:42.944079Z"}, {"name": "execute", "started_at": "2024-11-16T20:07:42.945244Z", "completed_at": "2024-11-16T20:07:42.945250Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005972385406494141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbtlearn.full_moon_no_sleep", "compiled": true, "compiled_code": "WITH fullmoon_reviews AS (\n    SELECT * FROM AIRBNB.DEV.full_moon_reviews\n)\nSELECT\n    is_full_moon,\n    review_sentiment,\n    COUNT(*) as reviews\nFROM\n    fullmoon_reviews\nGROUP BY\n    is_full_moon,\n    review_sentiment\nORDER BY\n    is_full_moon,\n    review_sentiment", "relation_name": null}], "elapsed_time": 1.727843999862671, "args": {"vars": {}, "write_json": true, "quiet": false, "select": [], "use_colors_file": true, "static": false, "version_check": true, "compile": true, "enable_legacy_logger": false, "introspect": true, "print": true, "project_dir": "/workspaces/DBT-Airbnb/dbtlearn", "defer": false, "partial_parse": true, "log_format": "default", "log_format_file": "debug", "use_colors": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "strict_mode": false, "favor_state": false, "printer_width": 80, "log_level_file": "debug", "log_path": "/workspaces/DBT-Airbnb/dbtlearn/logs", "show_resource_report": false, "macro_debugging": false, "populate_cache": true, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": false, "profiles_dir": "/home/codespace/.dbt", "exclude": [], "static_parser": true, "log_file_max_bytes": 10485760, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "empty_catalog": false, "which": "generate", "partial_parse_file_diff": true, "invocation_command": "dbt docs generate"}}